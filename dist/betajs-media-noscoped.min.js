/*!
betajs-media - v0.0.1 - 2015-03-15
Copyright (c) Oliver Friedmann
MIT Software License.
*/
(function(){var a=this.subScope();a.binding("module","global:BetaJS.Media"),a.binding("base","global:BetaJS"),a.binding("jquery","global:jQuery"),a.define("module:",function(){return{guid:"8475efdb-dd7e-402e-9f50-36c76945a692",version:".1426473310229"}}),a.define("module:Player.Flash",["base:Flash.FlashClassRegistry","base:Flash.Helper","base:Flash.FlashEmbedding","base:Browser.Dom","base:Strings","jquery:"],function(a,b,c,d,e,f){return{polyfill:function(a,b,c){return"video"==a.tagName.toLowerCase()&&"networkState"in a?a.networkState==a.NETWORK_NO_SOURCE||c?this.attach(d.changeTag(a,b||"videopoly")):a:this.attach(a)},__flashRegistrySingleton:function(){return this.__flashRegistry||(this.__flashRegistry=new a,this.__flashRegistry.register("flash.media.Video",["attachNetStream"]),this.__flashRegistry.register("flash.display.Sprite",["addChild"]),this.__flashRegistry.register("flash.display.Stage",[]),this.__flashRegistry.register("flash.net.NetStream",["play"]),this.__flashRegistry.register("flash.net.NetConnection",["connect"])),this.__flashRegistry},attach:function(a){for(var d=[".mp4",".flv"],g=[],h=0;h<a.childNodes.length;++h)a.childNodes[h].tagName&&"source"==a.childNodes[h].tagName.toLowerCase()&&a.childNodes[h].src&&g.push(a.childNodes[h].src.toLowerCase());for(var i=g[0],j=d.length-1,h=g.length-1;h>=0;--h)for(var k=0;j>=k;++k)if(e.ends_with(g[h],d[k])){i=g[h],j=k;break}-1==i.indexOf("://")&&(i=document.location.href+"/../"+i);var l=null,m=i;if(e.starts_with(i,"rtmp")){var n=e.splitLast(i,"/");l=n.head,m=n.tail}f(a).html(b.embedTemplate());var o,p=new c(f(a).find("embed").get(0),{registry:this.__flashRegistrySingleton(),wrap:!0});p.ready(function(){var b=p.flashMain(),c=b.get("stage");c.set("scaleMode","noScale"),c.set("align","TL");var d=p.newObject("flash.media.Video",c.get("stageWidth"),c.get("stageHeight"));b.addChildVoid(d);var e=p.newObject("flash.net.NetConnection");e.addEventListener("netStatus",function(){o=p.newObject("flash.net.NetStream",e),d.attachNetStreamVoid(o),a.attributes.autoplay&&a.play()}),e.connectVoid(l)}),a.play=function(){o.playVoid(m)}}}})}).call(Scoped);